[% page.js.push("ntppool.js"); USE Number.Format; %]

<div class="row product-header">
  <h3>Available subscriptions</h3>
</div>


[% FOR product_group = product_group_list %]

<div class="row product-header">
  <h4>[% product_group | ucfirst %]</h4>
</div>

  <div class="row">
  [% FOR pr = products_by_group.$product_group; %]
  <div class="col">

      <b>
        [% pr.Name %]
      </b>

  <ul class="product-details">
    <!--
  todo:
    encode the product ID somewhere that the javascript in ntppool.js can
    read it...
  -->
        [% IF pr.Description %]
        <li>
          [% pr.Description | html %]
        </li>
        [% END %]

        <li>
            [% IF pr.Available %]
            $[% pr.AnnualCost / 100 | format_number %] per year for up to [% pr.CostDevices | format_number %] devices<br>

            [% ELSE # not available ... %]
            [% IF pr.single_price %]
              $[% pr.AnnualCostLow / 100 | format_number %] [% tier.period_text %]
              [%- IF pr.MinClients %]
                for up to [% pr.MinClients | format_number %] devices
              [% END %]
            [% ELSIF pr.price %]
              (price) $[% pr.price / 100 | format_number %] [% tier.period_text %]
              <br>
              Starting at $[% pr.AnnualCostLow / 100 | format_number %] per year
              [%- IF pr.MinClients %]
                for up to [% pr.MinClients | format_number %] devices
              [% END %]
            [% END %]

            [% END %]

        </li>

        [% IF pr.tiered %]
        <li>
          <!-- (up to $[% pr.AnnualCostHigh / 100 %] per year) -->
          [% IF pr.MaxClients != pr.MinClients %]
          Plans with support for
          [% ELSE %]
          For
          [% END %]
          up to [% pr.MaxClients | format_number %] devices
        </li>
        [% END %]

        [% IF pr.MaxZones AND pr.MaxZones > 1 %]
        <li>Configure DNS for up to [% pr.MaxZones %] products</li>
        [% END %]

      </li>

      [% IF pr.Available %]
          <li class="continue">
          <br>
        [% FOR plan = pr.Plans %]

          [% IF plan.Available %]

          <form method="post" class="form-inline btn-inline" action="[% combust.manage_url('/manage/vendor/plan/create_session', id => vz.id_token ) %]">
          <input type="hidden" name="auth_token" value="[% combust.auth_token %]" />
          <input type="hidden" name="a" value="[% combust.current_account.id_token %]">
          <input type="hidden" name="product_id" value="[% pr.ID %]">
          <input type="hidden" name="price_id" value="[% plan.ID %]">
          <input type="submit" class="btn btn-primary"
            value="$[% plan.Cost / 100 | format_number | html %] [% plan.period_text | html %] &rarr;" />
          </form>

          [% END %]
        [% END %]

        [% IF product_group == "enterprise" %]
         <a class="btn btn-primary" href="mailto:[% " vendors" | email %]?subject=Enterprise vendor zone [% vz.zone_name |
            html %]">Email for custom plan &rarr;</a>
        [% END %]

                  </li>

      [% END %]

      [% UNLESS pr.Available %]
      <li>
        <small class="text-muted">
          Only for zones with less than [% pr.MaxClients | format_number %] devices.
        </small>

      </li>
      [% END %]


  </ul>

    </div>
      [% END # for products %]
</div>

[% END # for product_groups %]
